use exec_target_a::exec_target;

const TARGET_EXE_PATH: &'static str = "../../target/debug/cmp_docopt-curl";

macro_rules! some_stdout {
    () => {
        concat!(
            "CmdOptConf {",
            " flag_abstract_unix_socket: None,",
            " flag_alt_svc: None,",
            " flag_anyauth: false,",
            " flag_append: true,",
            " flag_basic: false,",
            " flag_cacert: None,",
            " flag_capath: None,",
            " flag_cert: None,",
            " flag_cert_status: false,",
            " flag_cert_type: None,",
            " flag_ciphers: None,",
            " flag_compressed: false,",
            " flag_compressed_ssh: false,",
            " flag_config: None,",
            " flag_connect_timeout: 50,",
            " flag_connect_to: None,",
            " flag_continue_at: 0,",
            " flag_cookie: None,",
            " flag_cookie_jar: None,",
            " flag_create_dirs: false,",
            " flag_crlf: false,",
            " flag_crlfile: None,",
            " flag_data: None,",
            " flag_data_ascii: None,",
            " flag_data_binary: None,",
            " flag_data_raw: None,",
            " flag_data_urlencode: None,",
            " flag_delegation: None,",
            " flag_digest: false,",
            " flag_disable: false,",
            " flag_disable_eprt: false,",
            " flag_disable_epsv: false,",
            " flag_disallow_username_in_url: false,",
            " flag_dns_interface: None,",
            " flag_dns_ipv4_addr: None,",
            " flag_dns_ipv6_addr: None,",
            " flag_dns_servers: None,",
            " flag_doh_url: None,",
            " flag_dump_header: None,",
            " flag_egd_file: None,",
            " flag_engine: None,",
            " flag_etag_save: None,",
            " flag_etag_compare: None,",
            " flag_expect100_timeout: 0,",
            " flag_fail: false,",
            " flag_fail_early: false,",
            " flag_false_start: false,",
            " flag_form: None,",
            " flag_form_string: None,",
            " flag_ftp_account: None,",
            " flag_ftp_alternative_to_user: None,",
            " flag_ftp_create_dirs: false,",
            " flag_ftp_method: None,",
            " flag_ftp_pasv: true,",
            " flag_ftp_port: None,",
            " flag_ftp_pret: false,",
            " flag_ftp_skip_pasv_ip: false,",
            " flag_ftp_ssl_ccc: false,",
            " flag_ftp_ssl_ccc_mode: None,",
            " flag_ftp_ssl_control: false,",
            " flag_get: false,",
            " flag_globoff: false,",
            " flag_happy_eyeballs_timeout_ms: 0,",
            " flag_haproxy_protocol: false,",
            " flag_head: false,",
            " flag_header: None,",
            " flag_hostpubmd5: None,",
            " flag_http0_9: false,",
            " flag_http1_0: false,",
            " flag_http1_1: false,",
            " flag_http2: true,",
            " flag_http2_prior_knowledge: false,",
            " flag_http3: false,",
            " flag_ignore_content_length: false,",
            " flag_include: false,",
            " flag_insecure: false,",
            " flag_interface: None,",
            " flag_ipv4: false,",
            " flag_ipv6: false,",
            " flag_junk_session_cookies: false,",
            " flag_keepalive_time: 0,",
            " flag_key: None,",
            " flag_key_type: None,",
            " flag_krb: None,",
            " flag_libcurl: None,",
            " flag_limit_rate: 0,",
            " flag_list_only: false,",
            " flag_local_port: None,",
            " flag_location: false,",
            " flag_location_trusted: false,",
            " flag_login_options: None,",
            " flag_mail_auth: None,",
            " flag_mail_from: None,",
            " flag_mail_rcpt: None,",
            " flag_manual: false,",
            " flag_max_filesize: 0,",
            " flag_max_redirs: 0,",
            " flag_max_time: 100,",
            " flag_metalink: false,",
            " flag_negotiate: false,",
            " flag_netrc: false,",
            " flag_netrc_file: None,",
            " flag_netrc_optional: false,",
            " flag_next: false,",
            " flag_no_alpn: true,",
            " flag_no_buffer: true,",
            " flag_no_keepalive: false,",
            " flag_no_npn: false,",
            " flag_no_progress_meter: false,",
            " flag_no_sessionid: false,",
            " flag_noproxy: None,",
            " flag_ntlm: false,",
            " flag_ntlm_wb: false,",
            " flag_oauth2_bearer: None,",
            " flag_output: None,",
            " flag_parallel: false,",
            " flag_parallel_immediate: false,",
            " flag_parallel_max: false,",
            " flag_pass: None,",
            " flag_path_as_is: false,",
            " flag_pinnedpubkey: None,",
            " flag_post301: false,",
            " flag_post302: false,",
            " flag_post303: false,",
            " flag_preproxy: None,",
            " flag_progress_bar: false,",
            " flag_proto: None,",
            " flag_proto_default: None,",
            " flag_proto_redir: None,",
            " flag_proxy: None,",
            " flag_proxy_anyauth: false,",
            " flag_proxy_basic: false,",
            " flag_proxy_cacert: None,",
            " flag_proxy_capath: None,",
            " flag_proxy_cert: None,",
            " flag_proxy_cert_type: None,",
            " flag_proxy_ciphers: None,",
            " flag_proxy_crlfile: None,",
            " flag_proxy_digest: false,",
            " flag_proxy_header: None,",
            " flag_proxy_insecure: false,",
            " flag_proxy_key: None,",
            " flag_proxy_key_type: None,",
            " flag_proxy_negotiate: false,",
            " flag_proxy_ntlm: false,",
            " flag_proxy_pass: None,",
            " flag_proxy_pinnedpubkey: None,",
            " flag_proxy_service_name: None,",
            " flag_proxy_ssl_allow_beast: false,",
            " flag_proxy_tls13_ciphers: None,",
            " flag_proxy_tlsauthtype: None,",
            " flag_proxy_tlspassword: None,",
            " flag_proxy_tlsuser: None,",
            " flag_proxy_tlsv1: false,",
            " flag_proxy_user: None,",
            " flag_proxy1_0: None,",
            " flag_proxytunnel: false,",
            " flag_pubkey: None,",
            " flag_quote: false,",
            " flag_random_file: None,",
            " flag_range: None,",
            " flag_raw: false,",
            " flag_referer: None,",
            " flag_remote_header_name: false,",
            " flag_remote_name: false,",
            " flag_remote_name_all: false,",
            " flag_remote_time: false,",
            " flag_request: None,",
            " flag_request_target: false,",
            " flag_resolve: None,",
            " flag_retry: 0,",
            " flag_retry_connrefused: false,",
            " flag_retry_delay: 0,",
            " flag_retry_max_time: 0,",
            " flag_sasl_authzid: None,",
            " flag_sasl_ir: false,",
            " flag_service_name: None,",
            " flag_show_error: false,",
            " flag_silent: false,",
            " flag_socks4: None,",
            " flag_socks4a: None,",
            " flag_socks5: None,",
            " flag_socks5_basic: false,",
            " flag_socks5_gssapi: false,",
            " flag_socks5_gssapi_nec: false,",
            " flag_socks5_gssapi_service: Some(\"name1\"),",
            " flag_socks5_hostname: None,",
            " flag_speed_limit: 0,",
            " flag_speed_time: 1000,",
            " flag_ssl: false,",
            " flag_ssl_allow_beast: false,",
            " flag_ssl_no_revoke: false,",
            " flag_ssl_reqd: false,",
            " flag_sslv2: false,",
            " flag_sslv3: true,",
            " flag_stderr: false,",
            " flag_styled_output: false,",
            " flag_suppress_connect_headers: false,",
            " flag_tcp_fastopen: false,",
            " flag_tcp_nodelay: false,",
            " flag_telnet_option: None,",
            " flag_tftp_blksize: 0,",
            " flag_tftp_no_options: false,",
            " flag_time_cond: None,",
            " flag_tls_max: None,",
            " flag_tls13_ciphers: None,",
            " flag_tlsauthtype: None,",
            " flag_tlspassword: false,",
            " flag_tlsuser: None,",
            " flag_tlsv1: false,",
            " flag_tlsv1_0: false,",
            " flag_tlsv1_1: false,",
            " flag_tlsv1_2: false,",
            " flag_tlsv1_3: false,",
            " flag_tr_encoding: false,",
            " flag_trace: None,",
            " flag_trace_ascii: None,",
            " flag_trace_time: false,",
            " flag_unix_socket: None,",
            " flag_upload_file: None,",
            " flag_url: None,",
            " flag_use_ascii: false,",
            " flag_user: None,",
            " flag_user_agent: None,",
            " flag_verbose: false,",
            " flag_write_out: None,",
            " flag_xattr: false,",
            " flag_help: false,",
            " flag_version: false,",
            " arg_getting_url: \"http://url1.com\" }\n",
        )
    };
}

#[test]
fn test_some_args() {
    #[rustfmt::skip]
    let oup = exec_target(
        TARGET_EXE_PATH,
        &["-a", "--connect-timeout", "50", "--ftp-pasv", "--http2",
            "--max-time", "100", "--no-alpn", "-N",
            "--socks5-gssapi-service", "name1", "-y", "1000", "--sslv3",
            "http://url1.com"]
    );
    assert_eq!(oup.status.success(), true);
    assert_eq!(oup.stdout, some_stdout!());
    assert_eq!(oup.stderr, "");
}
